(()=>{"use strict";const e={en:[[["1","Digit1"],["2","Digit2"],["3","Digit3"],["4","Digit4"],["5","Digit5"],["6","Digit6"],["7","Digit7"],["8","Digit8"],["9","Digit9"],["0","Digit0"],["-","Minus"],["=","Equal"],["backspace","Backspace"]],[["tab","Tab"],["q","KeyQ"],["w","KeyW"],["e","KeyE"],["r","KeyR"],["t","KeyT"],["y","KeyY"],["u","KeyU"],["i","KeyI"],["o","KeyO"],["p","KeyP"],["[","BracketLeft"],["]","BracketRight"],["del","Delete"]],[["caps","CapsLock"],["a","KeyA"],["s","KeyS"],["d","KeyD"],["f","KeyF"],["g","KeyG"],["h","KeyH"],["j","KeyJ"],["k","KeyK"],["l","KeyL"],[";","Semicolon"],['"',"Quote"],["\\","Backslash"],["enter","Enter"]],[["shift","ShiftLeft"],["z","KeyZ"],["x","KeyX"],["c","KeyC"],["v","KeyV"],["b","KeyB"],["n","KeyN"],["m","KeyM"],[",","Comma"],[".","Period"],["↑","ArrowUp"],["/","Slash"],["shift","ShiftRight"]],[["ctrl","ControlLeft"],["win","MetaLeft"],["alt","AltLeft"],["space","Space"],["alt","AltRight"],["←","ArrowLeft"],["↓","ArrowDown"],["→","ArrowRight"],["ctrl","ControlRight"]]],rus:[[["1","Digit1"],["2","Digit2"],["3","Digit3"],["4","Digit4"],["5","Digit5"],["6","Digit6"],["7","Digit7"],["8","Digit8"],["9","Digit9"],["0","Digit0"],["-","Minus"],["=","Equal"],["backspace","Backspace"]],[["tab","Tab"],["й","KeyQ"],["ц","KeyW"],["у","KeyE"],["к","KeyR"],["е","KeyT"],["н","KeyY"],["г","KeyU"],["ш","KeyI"],["щ","KeyO"],["з","KeyP"],["х","BracketLeft"],["ъ","BracketRight"],["del","Delete"]],[["caps","CapsLock"],["ф","KeyA"],["ы","KeyS"],["в","KeyD"],["а","KeyF"],["п","KeyG"],["р","KeyH"],["о","KeyJ"],["л","KeyK"],["д","KeyL"],["ж","Semicolon"],["э","Quote"],["ё","Backslash"],["enter","Enter"]],[["shift","ShiftLeft"],["я","KeyZ"],["ч","KeyX"],["с","KeyC"],["м","KeyV"],["и","KeyB"],["т","KeyN"],["ь","KeyM"],["б","Comma"],["ю","Period"],["↑","ArrowUp"],["/","Slash"],["shift","ShiftRight"]],[["ctrl","ControlLeft"],["win","MetaLeft"],["alt","AltLeft"],["space","Space"],["alt","AltRight"],["←","ArrowLeft"],["↓","ArrowDown"],["→","ArrowRight"],["ctrl","ControlRight"]]]};var t={content:{mainContainer:null,displayWindow:null,discriptionWindow:null,keyboardWindow:null,keyboardWrapper:null,keys:[]},data:{upperCase:!1,lang:"en",text:""},eventHandlers:{oninput:null,onclose:null},renderKeyboard:function(){var e=this;this.content.mainContainer=document.createElement("div"),this.content.discriptionWindow=document.createElement("div"),this.content.displayWindow=document.createElement("textarea"),this.content.keyboardWindow=document.createElement("div"),this.content.keyboardWrapper=document.createElement("div"),this.content.mainContainer.classList.add("container"),this.content.displayWindow.classList.add("display-window"),this.content.discriptionWindow.classList.add("description-window"),this.content.keyboardWindow.classList.add("keyboard-window"),this.content.keyboardWrapper.classList.add("keyboard-wrapper"),document.body.appendChild(this.content.mainContainer),this.content.keyboardWrapper.appendChild(this.buildKeys()),this.content.keyboardWindow.appendChild(this.content.keyboardWrapper),this.content.mainContainer.appendChild(this.content.displayWindow),this.content.discriptionWindow.innerHTML='<span class="description-window_text">Для переключения языка используйте сочетание  клавиш: \n        Left Shift+Alt(Option).<br>Клавиатура создана в операционной системе MacOS</span>',this.content.mainContainer.appendChild(this.content.discriptionWindow),this.content.mainContainer.appendChild(this.content.keyboardWindow),document.querySelectorAll(".display-window").forEach((function(t){t.addEventListener("focus",(function(){e.highlightKeyboard(t),e.open(t.value,(function(e){t.value=e}))}))})),document.querySelector("textarea").addEventListener("change",(function(){var t=document.querySelector("textarea");e.isEnglishInput(t.value)&&e.toggleLanguage(),e.isRussianInput(t.value)&&e.toggleLanguage()})),document.addEventListener("keydown",(function(e){t.highlightKeyboard(e),e.shiftKey&&e.altKey&&t.toggleLanguage();for(var n=document.querySelectorAll(".keyboard__key"),a=0;a<n.length;a+=1)e.code===n[a].getAttribute("name")&&n[a].classList.add("active")})),document.addEventListener("keyup",(function(e){for(var t=document.querySelectorAll(".keyboard__key"),n=0;n<t.length;n+=1)e.code===t[n].getAttribute("name")&&t[n].classList.remove("active")}))},buildKeys:function(){var t=this,n=document.createDocumentFragment();return e[this.data.lang].forEach((function(e){var a=document.createElement("div");a.classList.add("key-line"),e.forEach((function(e){t.content.keys.push(e);var i=document.createElement("div");switch(i.setAttribute("name","".concat(e[1])),i.classList.add("keyboard__key"),e[0]){case"backspace":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.addEventListener("click",(function(){var e=document.querySelector("textarea").selectionStart;t.data.text=t.data.text.slice(0,e-1)+t.data.text.slice(e),t.triggerEvent("oninput"),document.querySelector("textarea").selectionStart=e-1}));break;case"del":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.addEventListener("click",(function(){var e=document.querySelector("textarea").selectionStart;t.data.text=t.data.text.slice(0,e)+t.data.text.slice(e+1),t.triggerEvent("oninput"),document.querySelector("textarea").selectionStart=e}));break;case"win":case"ctrl":case"alt":case"shift":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1);break;case"caps":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.addEventListener("click",(function(){t.toggleCaps()}));break;case"tab":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.addEventListener("click",(function(){t.data.text+="    ",t.triggerEvent("oninput")}));break;case"enter":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.addEventListener("click",(function(){t.data.text+="\n",t.triggerEvent("oninput")}));break;case"space":i.innerText="".concat(e[0]).slice(0,1).toUpperCase()+"".concat(e[0]).slice(1),i.classList.add("keyboard__key_wide"),i.addEventListener("click",(function(){t.data.text+=" ",t.triggerEvent("oninput")}));break;default:i.innerText=t.data.upperCase?e[0].toUpperCase():e[0].toLowerCase(),i.addEventListener("click",(function(){t.data.text+=t.data.upperCase&&1===e[0].length?e[0].toUpperCase():e[0].toLowerCase(),t.triggerEvent("oninput")}))}a.appendChild(i),n.appendChild(a)}))})),n},highlightKeyboard:function(e){this.isEnglishInput(e)&&1===e.key.length&&(this.data.lang="rus",this.toggleLanguage()),this.isRussianInput(e)&&(this.data.lang="en",this.toggleLanguage())},isEnglishInput:function(e){var t=!1;return e.key&&(t=/[a-zA-Z]/.test(e.key)),t},isRussianInput:function(e){var t=!1;return e.key&&(t=/[а-яА-ЯЁё]/.test(e.key)),t},triggerEvent:function(e){"function"==typeof this.eventHandlers[e]&&this.eventHandlers[e](this.data.text)},open:function(e,t,n){this.data.text=e||"",this.eventHandlers.oninput=t,this.eventHandlers.onclose=n},toggleCaps:function(){this.data.upperCase=!this.data.upperCase;for(var e=0;e<this.content.keys.length;e+=1)this.content.keys[e].innerText&&(this.data.upperCase?(this.content.keys[e].innerText=this.content.keys[e].innerText.toUpperCase(),this.content.keys[e].setAttribute("name","".concat(this.content.keys[e].toUpperCase()))):(this.content.keys[e].innerText=this.content.keys[e].innerText.toLowerCase(),this.content.keys[e].setAttribute("name","".concat(this.content.keys[e].toLowerCase()))));localStorage.setItem("caps",this.data.upperCase)},toggleLanguage:function(){for(this.data.lang="en"===this.data.lang?"rus":"en";t.content.keyboardWrapper.firstChild;)t.content.keyboardWrapper.removeChild(t.content.keyboardWrapper.firstChild);localStorage.setItem("lang",this.data.lang),t.content.keyboardWrapper.appendChild(t.buildKeys())},getLocalStorage:function(){if(localStorage.getItem("lang")){var e=localStorage.getItem("lang");for(this.data.lang=e;t.content.keyboardWrapper.firstChild;)t.content.keyboardWrapper.removeChild(t.content.keyboardWrapper.firstChild);t.content.keyboardWrapper.appendChild(t.buildKeys())}if(localStorage.getItem("caps")){var n=localStorage.getItem("caps");for(this.data.upperCase=n;t.content.keyboardWrapper.firstChild;)t.content.keyboardWrapper.removeChild(t.content.keyboardWrapper.firstChild);t.content.keyboardWrapper.appendChild(t.buildKeys())}},close:function(){this.data.text="",this.eventHandlers.oninput=oninput,this.eventHandlers.onclose=onclose}};window.onload=function(){t.renderKeyboard(),window.addEventListener("load",t.getLocalStorage())}})();